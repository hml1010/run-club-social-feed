
<view class="container">
  <!-- è¿åŠ¨æ‰“å¡æŒ‰é’® -->
  <view class="card">
    <view class="card-content">
      <button class="btn-primary" bindtap="showCheckinModal">
        <text>ğŸƒâ€â™‚ï¸ è¿åŠ¨æ‰“å¡</text>
      </button>
    </view>
  </view>

  <!-- æœ¬å‘¨ç›®æ ‡å¡ç‰‡ -->
  <view class="card">
    <view class="card-header">
      <view style="display: flex; align-items: center; gap: 16rpx;">
        <text>ğŸ¯</text>
        <text class="card-title">æœ¬å‘¨ç›®æ ‡</text>
      </view>
    </view>
    <view class="card-content">
      <view class="goal-item">
        <view style="display: flex; justify-content: space-between; margin-bottom: 16rpx;">
          <text>è¿åŠ¨å¤©æ•°</text>
          <text>{{weeklyStats.days}} / 5 å¤©</text>
        </view>
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{weeklyStats.daysProgress}}%;"></view>
        </view>
      </view>
      
      <view class="goal-item" style="margin-top: 32rpx;">
        <view style="display: flex; justify-content: space-between; margin-bottom: 16rpx;">
          <text>è¿åŠ¨æ—¶é•¿</text>
          <text>{{weeklyStats.duration}} / 300 åˆ†é’Ÿ</text>
        </view>
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{weeklyStats.durationProgress}}%;"></view>
        </view>
      </view>
    </view>
  </view>

  <!-- è¿åŠ¨åŠ¨æ€ -->
  <view class="card">
    <view class="card-header">
      <text class="card-title">æœ€æ–°åŠ¨æ€</text>
    </view>
    <view class="card-content">
      <view wx:for="{{feedData}}" wx:key="id" class="feed-item">
        <view class="user-info">
          <image class="avatar" src="{{item.user.avatar}}" mode="aspectFill"></image>
          <view>
            <view class="user-name">{{item.user.name}}</view>
            <view class="user-level">{{item.user.level}}</view>
            <view style="color: #999; font-size: 24rpx; margin-top: 8rpx;">{{item.time}}</view>
          </view>
        </view>
        
        <view style="margin: 20rpx 0; color: #333; line-height: 1.6;">
          {{item.description}}
        </view>
        
        <view class="stats-grid">
          <view class="stat-item">
            <view class="stat-value">{{item.duration}}</view>
            <view class="stat-label">æ—¶é•¿</view>
          </view>
          <view class="stat-item" wx:if="{{item.distance}}">
            <view class="stat-value">{{item.distance}}</view>
            <view class="stat-label">è·ç¦»</view>
          </view>
          <view class="stat-item">
            <view class="stat-value">{{item.calories}}</view>
            <view class="stat-label">å¡è·¯é‡Œ</view>
          </view>
        </view>
        
        <view style="display: flex; align-items: center; gap: 16rpx; margin-top: 20rpx; color: #999;">
          <text>ğŸ“ {{item.location}}</text>
        </view>
        
        <view style="display: flex; justify-content: space-between; margin-top: 20rpx; padding-top: 20rpx; border-top: 1rpx solid #eee;">
          <view bindtap="toggleLike" data-id="{{item.id}}" style="display: flex; align-items: center; gap: 8rpx; color: #667eea;">
            <text>â¤ï¸</text>
            <text>{{item.likes}}</text>
          </view>
          <view style="display: flex; align-items: center; gap: 8rpx; color: #667eea;">
            <text>ğŸ’¬</text>
            <text>{{item.comments}}</text>
          </view>
        </view>
        
        <view wx:if="{{index < feedData.length - 1}}" style="height: 1rpx; background: #eee; margin: 40rpx 0;"></view>
      </view>
    </view>
  </view>

  <!-- æœ¬å‘¨æ’è¡Œæ¦œé¢„è§ˆ -->
  <view class="card">
    <view class="card-header">
      <view style="display: flex; justify-content: space-between; align-items: center;">
        <text class="card-title">ğŸ† æœ¬å‘¨æ’è¡Œ</text>
        <text bindtap="goToRanking" style="color: #667eea; font-size: 28rpx;">æŸ¥çœ‹æ›´å¤š ></text>
      </view>
    </view>
    <view class="card-content">
      <view wx:for="{{topRanking}}" wx:key="rank" class="ranking-item">
        <view style="display: flex; align-items: center; gap: 20rpx;">
          <view class="rank-number rank-{{item.rank <= 3 ? item.rank : 'other'}}">
            {{item.rank}}
          </view>
          <view>
            <view style="font-weight: 600; color: #333;">{{item.name}}</view>
            <view style="color: #666; font-size: 24rpx;">{{item.score}} ç§¯åˆ†</view>
          </view>
        </view>
        <view style="color: {{item.change.includes('+') ? '#4caf50' : item.change.includes('-') ? '#f44336' : '#999'}}; font-size: 24rpx;">
          {{item.change}}
        </view>
      </view>
    </view>
  </view>
</view>

<!-- æ‰“å¡æ¨¡æ€æ¡† -->
<view wx:if="{{showCheckin}}" class="modal-overlay" bindtap="hideCheckinModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view style="text-align: center; margin-bottom: 40rpx;">
      <text style="font-size: 36rpx; font-weight: bold;">è¿åŠ¨æ‰“å¡</text>
    </view>
    
    <view class="form-group">
      <text class="form-label">è¿åŠ¨ç±»å‹</text>
      <picker range="{{sportTypes}}" value="{{checkinForm.sportIndex}}" bindchange="onSportChange">
        <view class="picker-text">{{sportTypes[checkinForm.sportIndex]}}</view>
      </picker>
    </view>
    
    <view class="form-group">
      <text class="form-label">è¿åŠ¨æ—¶é•¿ (åˆ†é’Ÿ)</text>
      <input class="form-input" type="number" placeholder="è¯·è¾“å…¥è¿åŠ¨æ—¶é•¿" value="{{checkinForm.duration}}" bindinput="onDurationInput" />
    </view>
    
    <view class="form-group">
      <text class="form-label">ä»Šæ—¥æ„Ÿå—</text>
      <textarea class="form-textarea" placeholder="åˆ†äº«ä¸€ä¸‹ä»Šå¤©çš„è¿åŠ¨å¿ƒå¾—..." value="{{checkinForm.description}}" bindinput="onDescriptionInput"></textarea>
    </view>
    
    <view style="display: flex; gap: 20rpx; margin-top: 40rpx;">
      <button class="btn-secondary" bindtap="hideCheckinModal">å–æ¶ˆ</button>
      <button class="btn-primary" bindtap="submitCheckin">æäº¤æ‰“å¡</button>
    </view>
  </view>
</view>
